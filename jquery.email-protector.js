// Generated by CoffeeScript 1.6.3
(function() {
  var $;

  $ = jQuery;

  $.fn.extend({
    emailProtector: function(options) {
      return this.each(function() {
        var el, parts, query, queryMatch;
        el = $(this);
        parts = el.attr('data-email-protector').split('|');
        if (parts.length === 2) {
          if (queryMatch = parts[1].match(/(\?.+)/)) {
            query = queryMatch[1];
            parts[1] = parts[1].substring(0, parts[1].indexOf('?'));
          }
          if (!el.attr('data-email-protector-preserve-text')) {
            el.text("" + parts[0] + "@" + parts[1]);
          }
          return el.attr('href', "mailto:" + parts[0] + "@" + parts[1] + (query != null ? query : ''));
        } else {
          return el.text("Invalid format. eg. <a data-email-protector=\"foo|bar.com\"></a> will become <a href=\"mailto:foo@bar.com\"></a>.");
        }
      });
    }
  });

}).call(this);
